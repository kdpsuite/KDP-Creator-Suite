- name: Setup Flutter & Build APKs
  run: |
    # Install dependencies
    sudo apt-get update -y
    sudo apt-get install -y curl git unzip xz-utils zip libglu1-mesa libgtk-3-dev clang cmake ninja-build pkg-config

    # Clone Flutter pre-release
    git clone https://github.com/flutter/flutter.git -b beta
    cd flutter
    git checkout 3.37.0-0.1.pre
    cd ..

    # Add Flutter to PATH for this step
    export PATH="$PWD/flutter/bin:$PATH"

    # Verify Flutter
    flutter --version
    flutter doctor -v

    # Accept Android licenses
    yes | flutter doctor --android-licenses

    # Navigate to project and install dependencies
    cd mobile-app
    flutter pub get

    # Build APKs
    flutter build apk --debug
    flutter build apk --release
